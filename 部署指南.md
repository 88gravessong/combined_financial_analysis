# ğŸš€ è´¢åŠ¡æ•°æ®åˆ†æç³»ç»Ÿ - å®¹å™¨åŒ–éƒ¨ç½²æŒ‡å—

## ğŸ“‹ ç›®å½•
- [æœ¬åœ°æµ‹è¯•](#æœ¬åœ°æµ‹è¯•)
- [äº‘æœåŠ¡å™¨éƒ¨ç½²](#äº‘æœåŠ¡å™¨éƒ¨ç½²)
- [äº‘å®¹å™¨æœåŠ¡éƒ¨ç½²](#äº‘å®¹å™¨æœåŠ¡éƒ¨ç½²)
- [ç›‘æ§å’Œç»´æŠ¤](#ç›‘æ§å’Œç»´æŠ¤)
- [æ•…éšœæ’é™¤](#æ•…éšœæ’é™¤)

## ğŸ§ª æœ¬åœ°æµ‹è¯•

### 1. æ„å»ºå’Œè¿è¡Œå®¹å™¨

```bash
# æ„å»ºDockeré•œåƒ
docker build -t financial-analysis .

# è¿è¡Œå®¹å™¨ï¼ˆç®€å•æ¨¡å¼ï¼‰
docker run -p 8080:8080 financial-analysis

# æˆ–è€…ä½¿ç”¨Docker Composeï¼ˆæ¨èï¼‰
docker-compose up --build
```

### 2. è®¿é—®åº”ç”¨
- æ‰“å¼€æµè§ˆå™¨è®¿é—®: http://localhost:8080
- æµ‹è¯•æ–‡ä»¶ä¸Šä¼ å’Œåˆ†æåŠŸèƒ½

### 3. ç”Ÿäº§æ¨¡å¼æµ‹è¯•ï¼ˆå¸¦Nginxï¼‰
```bash
# å¯åŠ¨åŒ…å«Nginxçš„å®Œæ•´ç¯å¢ƒ
docker-compose --profile production up --build
```

## ğŸŒ äº‘æœåŠ¡å™¨éƒ¨ç½²

### æ–¹æ¡ˆ1: é˜¿é‡Œäº‘ECS + Docker

#### 1. è´­ä¹°äº‘æœåŠ¡å™¨
- **æ¨èé…ç½®**: 2æ ¸4Gå†…å­˜ï¼Œ40G SSD
- **æ“ä½œç³»ç»Ÿ**: Ubuntu 20.04 LTS
- **ç½‘ç»œ**: å…¬ç½‘IPï¼Œå¼€æ”¾80å’Œ443ç«¯å£

#### 2. æœåŠ¡å™¨åˆå§‹åŒ–
```bash
# è¿æ¥åˆ°æœåŠ¡å™¨
ssh root@your-server-ip

# æ›´æ–°ç³»ç»Ÿ
apt update && apt upgrade -y

# å®‰è£…Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sh get-docker.sh

# å®‰è£…Docker Compose
curl -L "https://github.com/docker/compose/releases/download/v2.20.0/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
chmod +x /usr/local/bin/docker-compose

# å¯åŠ¨DockeræœåŠ¡
systemctl start docker
systemctl enable docker
```

#### 3. éƒ¨ç½²åº”ç”¨
```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/88gravessong/combined_financial_analysis.git
cd combined_financial_analysis

# ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
docker-compose --profile production up -d --build

# æŸ¥çœ‹è¿è¡ŒçŠ¶æ€
docker-compose ps
```

### æ–¹æ¡ˆ2: è…¾è®¯äº‘è½»é‡åº”ç”¨æœåŠ¡å™¨

#### 1. ä¸€é”®éƒ¨ç½²è„šæœ¬
```bash
#!/bin/bash
# ä¿å­˜ä¸º deploy.sh

echo "ğŸš€ å¼€å§‹éƒ¨ç½²è´¢åŠ¡åˆ†æç³»ç»Ÿ..."

# å®‰è£…Docker
curl -fsSL https://get.docker.com | sh
systemctl start docker
systemctl enable docker

# å…‹éš†ä»£ç 
git clone https://github.com/88gravessong/combined_financial_analysis.git
cd combined_financial_analysis

# å¯åŠ¨æœåŠ¡
docker-compose up -d --build

echo "âœ… éƒ¨ç½²å®Œæˆï¼"
echo "ğŸ“Š è®¿é—®åœ°å€: http://$(curl -s ifconfig.me):8080"
```

## â˜ï¸ äº‘å®¹å™¨æœåŠ¡éƒ¨ç½²

### é˜¿é‡Œäº‘å®¹å™¨æœåŠ¡ACK

#### 1. åˆ›å»ºKubernetesé…ç½®
```yaml
# k8s-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: financial-analysis
  labels:
    app: financial-analysis
spec:
  replicas: 2
  selector:
    matchLabels:
      app: financial-analysis
  template:
    metadata:
      labels:
        app: financial-analysis
    spec:
      containers:
      - name: financial-analysis
        image: your-registry/financial-analysis:latest
        ports:
        - containerPort: 8080
        resources:
          limits:
            memory: "1Gi"
            cpu: "500m"
          requests:
            memory: "512Mi"
            cpu: "250m"
---
apiVersion: v1
kind: Service
metadata:
  name: financial-analysis-service
spec:
  selector:
    app: financial-analysis
  ports:
    - protocol: TCP
      port: 80
      targetPort: 8080
  type: LoadBalancer
```

#### 2. éƒ¨ç½²åˆ°ACK
```bash
# æ„å»ºå¹¶æ¨é€é•œåƒåˆ°é˜¿é‡Œäº‘å®¹å™¨é•œåƒæœåŠ¡
docker build -t registry.cn-hangzhou.aliyuncs.com/your-namespace/financial-analysis:latest .
docker push registry.cn-hangzhou.aliyuncs.com/your-namespace/financial-analysis:latest

# éƒ¨ç½²åˆ°K8s
kubectl apply -f k8s-deployment.yaml
```

### è…¾è®¯äº‘å®¹å™¨æœåŠ¡TKE

#### 1. ä½¿ç”¨è…¾è®¯äº‘æ§åˆ¶å°
- åˆ›å»ºTKEé›†ç¾¤
- é€šè¿‡æ§åˆ¶å°å¯¼å…¥Dockeré•œåƒ
- é…ç½®è´Ÿè½½å‡è¡¡å’Œè‡ªåŠ¨æ‰©ç¼©å®¹

## ğŸ“Š ç›‘æ§å’Œç»´æŠ¤

### 1. å¥åº·æ£€æŸ¥
```bash
# æ£€æŸ¥å®¹å™¨çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f financial-analysis

# é‡å¯æœåŠ¡
docker-compose restart
```

### 2. æ€§èƒ½ç›‘æ§
```bash
# æŸ¥çœ‹èµ„æºä½¿ç”¨æƒ…å†µ
docker stats

# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
docker-compose logs --tail=100 financial-analysis
```

### 3. å¤‡ä»½å’Œæ›´æ–°
```bash
# æ›´æ–°åº”ç”¨
git pull origin main
docker-compose down
docker-compose up --build -d

# æ¸…ç†æ—§é•œåƒ
docker image prune -f
```

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **ç«¯å£è¢«å ç”¨**
   ```bash
   # æŸ¥çœ‹ç«¯å£å ç”¨
   netstat -tulpn | grep :8080
   # ä¿®æ”¹docker-compose.ymlä¸­çš„ç«¯å£æ˜ å°„
   ```

2. **å†…å­˜ä¸è¶³**
   ```bash
   # å¢åŠ äº¤æ¢ç©ºé—´
   fallocate -l 2G /swapfile
   chmod 600 /swapfile
   mkswap /swapfile
   swapon /swapfile
   ```

3. **æ–‡ä»¶ä¸Šä¼ å¤±è´¥**
   - æ£€æŸ¥`client_max_body_size`è®¾ç½®
   - ç¡®è®¤ç£ç›˜ç©ºé—´å……è¶³

### æ—¥å¿—æŸ¥çœ‹
```bash
# å®æ—¶æŸ¥çœ‹åº”ç”¨æ—¥å¿—
docker-compose logs -f

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
docker-compose logs financial-analysis
```

## ğŸ’° æˆæœ¬ä¼°ç®—

### äº‘æœåŠ¡å™¨æ–¹æ¡ˆ
- **é˜¿é‡Œäº‘ECS**: 2æ ¸4Gçº¦200-300å…ƒ/æœˆ
- **è…¾è®¯äº‘è½»é‡**: 2æ ¸4Gçº¦100-200å…ƒ/æœˆ
- **åä¸ºäº‘ECS**: 2æ ¸4Gçº¦150-250å…ƒ/æœˆ

### å®¹å™¨æœåŠ¡æ–¹æ¡ˆ
- **é˜¿é‡Œäº‘ACK**: çº¦500-800å…ƒ/æœˆ
- **è…¾è®¯äº‘TKE**: çº¦400-700å…ƒ/æœˆ

## ğŸ¯ æ¨èéƒ¨ç½²é¡ºåº

1. **æœ¬åœ°æµ‹è¯•** âœ…
2. **äº‘æœåŠ¡å™¨éƒ¨ç½²** (æ¨èæ–°æ‰‹)
3. **å®¹å™¨æœåŠ¡éƒ¨ç½²** (æ¨èä¼ä¸šç”¨æˆ·)
4. **ç›‘æ§é…ç½®**
5. **åŸŸåå’ŒSSLè¯ä¹¦é…ç½®**

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. Dockerå’ŒDocker Composeç‰ˆæœ¬
2. é˜²ç«å¢™è®¾ç½®
3. æœåŠ¡å™¨èµ„æºä½¿ç”¨æƒ…å†µ
4. åº”ç”¨æ—¥å¿—è¾“å‡º 