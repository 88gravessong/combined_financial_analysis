# 财务数据分析系统 - 使用说明

## 🎯 系统概览

本系统现在支持两个分析模块：

### 📊 模块选择

1. **🇮🇩 印尼财务数据分析**（原模块）
   - 适用于印尼跨境电商的财务数据分析
   - 支持组合SKU处理和汇率转换
   - 支持多文件上传和合并

2. **🇲🇾 马来跨境店财务数据分析**（新模块）
   - 适用于马来西亚跨境店的财务数据分析
   - 支持操作费计算和利润分析
   - 支持多文件上传和合并
   - 特殊处理：自动跳过订单表第2行注释

## 🚀 启动系统

```bash
# 进入项目目录
cd /path/to/your/project

# 启动服务器
python app.py
```

系统将在 `http://localhost:8080` 启动

## 💻 使用步骤

### 1. 选择分析模块
- 访问 `http://localhost:8080`
- 在页面顶部选择需要的分析模块：
  - 印尼财务数据分析
  - 马来跨境店财务数据分析

### 2. 上传文件
按顺序上传以下文件：

#### 📋 订单表
- 支持多个Excel文件
- 系统会自动合并所有文件
- 马来模块会自动跳过第2行注释

#### 💳 结算表
- 支持多个Excel文件
- 系统会自动合并所有文件
- 马来模块会自动过滤Type='order'的记录

#### 📊 产品成本消耗表
- 只支持单个Excel文件
- 包含SKU成本和广告消耗信息

### 3. 开始分析
- 确保所有必要文件已上传
- 点击"🚀 开始分析"按钮
- 等待处理完成

### 4. 下载结果
- 分析完成后，点击"📥 下载结果文件"
- 印尼模块输出：`印尼财务分析结果.xlsx`
- 马来模块输出：`马来跨境店财务分析结果.xlsx`

## 📁 输出文件内容

### 印尼模块输出
- 订单数据分析表
- SKU汇总表
- 利润分析表

### 马来模块输出
- 订单表_含结算金额和操作费
- sku总结算金额和操作费
- 产品消耗成本表

## ⚙️ 技术特性

### 多文件支持
- ✅ 订单表：支持多文件合并
- ✅ 结算表：支持多文件合并
- ✅ 消耗表：单文件上传

### 数据处理
- ✅ 自动数据类型转换
- ✅ 重复数据处理
- ✅ 错误数据过滤
- ✅ 汇率转换（印尼模块）
- ✅ 操作费计算（马来模块）

### 用户体验
- ✅ 拖拽上传
- ✅ 实时进度显示
- ✅ 错误信息提示
- ✅ 响应式设计

## 🛠️ 故障排除

### 常见问题

1. **文件上传失败**
   - 检查文件格式（仅支持.xlsx, .xls）
   - 确保文件大小不超过100MB

2. **分析失败**
   - 检查文件内容格式是否正确
   - 确保必要的列存在
   - 查看错误信息提示

3. **服务器无法启动**
   - 检查端口8080是否被占用
   - 确保所有依赖已安装

### 日志查看
服务器运行时会在控制台显示详细的处理日志，包括：
- 文件读取状态
- 数据合并信息
- 处理进度
- 错误信息

## 📞 技术支持

如果遇到问题，请检查：
1. 文件格式是否符合要求
2. 数据列名是否正确
3. 服务器日志中的错误信息

---

*系统版本：2.0 - 支持印尼和马来模块* 